<div class="clr-row">
    <div class="card" style="margin-top: 0em;">
        <div class="card-header">
            Daftar Promosi
        </div>
        <div class="card-block">
            <div class="card-text">
                <form clrForm [formGroup]="search" (ngSubmit)="filterPromotion('id')">
                    <div class="clr-row clr-align-items-center">
                        <div class="clr-col-3">
                            <clr-date-container>
                                <input clrDate type="date" formControlName="from">
                            </clr-date-container>
                        </div>
                        <div class="clr-col-3">
                            <clr-date-container>
                                <input clrDate type="date" formControlName="to">
                            </clr-date-container>
                        </div>
                        <div class="clr-col-3">
                            <clr-input-container>
                                <input clrInput type="text" formControlName="text" placeholder="search" autofocus>
                            </clr-input-container>
                        </div>
                        <div class="clr-col-2">
                            <button type="submit" class="btn btn-icon btn-sm btn-success">Search</button>
                        </div>
                    </div>                   
                </form>
                <!-- Data Grid -->
                <clr-datagrid [clrDgLoading]="loadingDg">
                    <clr-dg-placeholder>{{placeholderDatagrid}}</clr-dg-placeholder>

                    <clr-dg-column>Nama Program</clr-dg-column>
                    <clr-dg-column>Pembuat Program</clr-dg-column>
                    <clr-dg-column>Tanggal Pembuatan</clr-dg-column>
                    <clr-dg-column>Status</clr-dg-column>
                    <clr-dg-column class="right"></clr-dg-column>

                    <clr-dg-row *ngFor="let data of promotion" > 
                        <clr-dg-action-overflow>
                            <button class="action-item">Detail</button>
                            <ng-container *ngIf="data.flag == 0" >
                                <!-- submitted -->
                                <button class="action-item" (click)="actionView(data._hash)">Action</button>
                            </ng-container>
                        </clr-dg-action-overflow>
                        <clr-dg-cell>{{data.name}}</clr-dg-cell>
                        <clr-dg-cell>{{data.maker.name}} - {{data.maker.unit.nama}}</clr-dg-cell>
                        <clr-dg-cell>{{data.makerDate}}, {{data.makerTime}}</clr-dg-cell>
                        <ng-container *ngIf="data.flag == 0" >
                            <!-- submitted -->
                            <clr-dg-cell><span class="badge badge-info">Submitted</span></clr-dg-cell>
                        </ng-container>
                        <ng-container *ngIf="data.flag == 1">
                            <!-- approve -->
                            <span class="badge badge-success">Approve</span>
                        </ng-container>
                        <ng-container *ngIf="data.flag == 2">
                            <!-- rejected -->
                            <span class="badge badge-danger">Rejected</span>
                        </ng-container>
                        <clr-dg-cell>button</clr-dg-cell>
                        
                    </clr-dg-row>
                </clr-datagrid>
            </div>
        </div>
    </div>

</div>

<!-- Modals -->
<ng-container *ngIf="actionModal">
    <clr-modal [(clrModalOpen)]="actionModal" [clrModalSize]="'lg'">
        <h3 class="modal-title">Promosi {{data.name}}</h3>
        <div class="modal-body">
            <form clrForm class="clr-form-compact" >
                <clr-input-container>
                    <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Nama Program</label>
                    <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                    <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{data.name}}</label>
                </clr-input-container>
                <clr-input-container>
                    <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Maker</label>
                    <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                    <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{data.maker.name}}</label>
                </clr-input-container>
                <clr-input-container>
                    <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Maker Date/Time</label>
                    <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                    <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{data.makerDate+', '+data.makerTime}}</label>
                </clr-input-container>

                <!-- Type Quota -->
                <ng-container *ngIf="data.typeQuota == 0">
                    <!-- tidak ada batasan -->
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Tipe Kuota</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Tidak Ada Batasan</label>
                    </clr-input-container>                    
                </ng-container>
                <ng-container *ngIf="data.typeQuota == 1">
                    <!-- Semua Produk -->
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Tipe Kuota</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Semua Product</label>
                    </clr-input-container>
                </ng-container>
                <ng-container *ngIf="data.typeQuota == 2">
                    <!-- per product -->
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Tipe Kuota</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Per Product</label>
                    </clr-input-container>
                </ng-container>
                <!-- end type quota -->
                
                <ng-container *ngIf="data.typeQuota == 1">
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Kuota</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{data.quota}}</label>
                    </clr-input-container>
                </ng-container>   
                
                <clr-input-container>
                    <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Start/End Date</label>
                    <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                    <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{data.startDate+' - '+data.endDate}}</label>
                </clr-input-container>
                
                <ng-container *ngIf="data.units == 1; else distroList">
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Distro</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Semua Distro</label>
                    </clr-input-container>
                </ng-container>
                <ng-template #distroList>
                    <clr-input-container>
                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Distro</label>
                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">
                            <ol class="list">
                                <li *ngFor="let isi of data.units">{{isi.nama}}</li>
                            </ol>
                        </label>
                    </clr-input-container>
                </ng-template>

                <clr-input-container>
                    <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Produk</label>
                    <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                    <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">
                        <ol class="list">
                            <li *ngFor="let isi of data['product-category']">{{isi.name}}</li>
                        </ol>
                    </label>
                </clr-input-container><br>
                
                <div class="card" style="margin-top: 0em;">   
                    <div class="card-header">
                        Pengaturan Promo Produk
                    </div>   
                    <div class="card-block">
                        <div class="card-text">

                            <div class="card" style="margin-top: 0em;" *ngFor="let product of data['product-category']">   
                                <div class="card-header">
                                    {{product.name}}
                                </div>   
                                <div class="card-block">
                                    <div class="card-text">
                                        <ng-container *ngFor="let li of data.product">
                                            <!-- Perhiasan -->
                                            <ng-container *ngIf="product.code == li.code">
                                                <form clrForm class="clr-form-compact">
                                                    <clr-input-container>
                                                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">tipe Perhiasan</label>
                                                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">
                                                            <ol class="list">
                                                                <li *ngFor="let isi of li.typePerhiasan">{{isi.name}}</li>
                                                            </ol>
                                                        </label>
                                                    </clr-input-container>
                                                    <clr-input-container>
                                                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Kadar</label>
                                                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">
                                                            <ol class="list">
                                                                <li *ngFor="let isi of li.purity">{{isi.name}}</li>
                                                            </ol>
                                                        </label>
                                                    </clr-input-container>
                                                    <clr-input-container>
                                                        <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Vendor</label>
                                                        <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                        <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">
                                                            <ol class="list">
                                                                <li *ngFor="let isi of li.vendor">{{isi.name}}</li>
                                                            </ol>
                                                        </label>
                                                    </clr-input-container>
                                                    <ng-container *ngIf="data.typeQuota == 2">
                                                        <clr-input-container>
                                                            <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Kuota</label>
                                                            <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                            <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{li.quota}}</label>
                                                        </clr-input-container>
                                                    </ng-container> 
                                                    <ng-container *ngIf="li.age == 'su'; else du">
                                                        <clr-input-container>
                                                            <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Umur</label>
                                                            <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                            <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Semua Umur</label>
                                                        </clr-input-container>
                                                    </ng-container>
                                                    <ng-template #du>
                                                        <clr-input-container>
                                                            <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Umur</label>
                                                            <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                            <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">Dengan Umur</label>
                                                        </clr-input-container>
                                                        <clr-input-container>
                                                            <label class="clr-col-sm-3 clr-col-md-3 clr-col-lg-3">Range Umur</label>
                                                            <label class="clr-col-sm-1 clr-col-md-1 clr-col-lg-1">:</label>
                                                            <label class="clr-col-sm-8 clr-col-md-8 clr-col-lg-8">{{li.minAge}} - {{li.maxAge}}</label>
                                                        </clr-input-container>
                                                    </ng-template>
                                                </form>
                                            </ng-container>
                                            <!-- end Perhiasan -->
                                        </ng-container>
                                        
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </form>           

            
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-outline" (click)="actionModal = false">Cancel</button>
            <button type="button" class="btn btn-primary" (click)="actionModal = false">Ok</button>
        </div>
    </clr-modal>
</ng-container>